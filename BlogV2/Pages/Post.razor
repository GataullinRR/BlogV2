@page "/post/{Id}"
@inject IBlogService Blog

@if(_post != null)
{
    <div class="col">
        <h3>@_post.Title</h3>

        <div class="mce-content-body text-justify" id="tinymce" data-id="Body">
            @((MarkupString)_post.Body)
        </div>

        <div class="d-flex text-muted mt-2">
            <span style="white-space: pre">Written by @_post.Author.UserName (@_post.Author.Email)</span>
            <span class="ml-auto">@_post.CreationTime.ToLocalTime().ToString("dd.MM.yyyy")</span>
        </div>
    </div>
}

@code {
    public static string GetPath(int postId)
    {
        return $"/post/{postId}";
    }

    [Parameter]
    public string? Id { get; set; }

    private BlogService.Db.Post _post;

    protected override async Task OnParametersSetAsync()
    {
        _post = (await Blog.QueryPostsAsync(QueryPostsRequest.QueryByIds(int.Parse(Id)))).Posts.FirstOrDefault();

        await base.OnParametersSetAsync();
    }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
    }
}
